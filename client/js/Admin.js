var Admin=function(t,e,i){this.self=this,this.onyen=t,this.uid=e,this.pid=i,this.students=[],this.terms=[],this.verify(),this.getTerms(),this.addListeners()};Admin.prototype.verify=function(){return this.onyen&&this.uid&&this.pid?void $.ajax({url:dbUrl+"verifyAdmin/",type:"GET",data:{UID:this.uid},success:function(t){t.isAdmin?(this.addGameButton(),this.getTerms()):this.redirect()}.bind(this),error:function(t){this.redirect()}.bind(this)}):void this.redirect()},Admin.prototype.addGameButton=function(){var t="?status=pass&onyen="+this.onyen+"&pid="+this.pid+"&uid="+this.uid;$(".title-buttons").append('<a href="/'+t+'"><button class="btn btn-primary">Back To Game</button></a>')},Admin.prototype.redirect=function(){alert("Sorry. You are not an admin."),window.location.replace("http://philgames-neta.apps.unc.edu/")},Admin.prototype.addListeners=function(){$("#makeAdmin").click(this.makeAdmin.bind(this)),$("#removeAdmin").click(this.removeAdmin.bind(this)),$("#addTerm").click(this.addTerm.bind(this)),$("#term-select").change(this.selectTerm.bind(this))},Admin.prototype.displayTerms=function(){if(0!==this.terms.length&&null!=this.terms[0]){for(var t="",e=0;e<this.terms.length;e++)t+="<option>"+this.terms[e]+"</option>";$("#term-select").html(t),$("#term-select").val(this.terms[this.terms.length-1]),this.selectTerm()}},Admin.prototype.selectTerm=function(){term=$("#term-select").val(),$(".current-term").html(term),this.getTerm(term)},Admin.prototype.displayStudents=function(){var t=$(".table > tbody");t.html("");for(var e=0;e<this.students.length;e++){this.students[e];t.append(this.tableRow(this.students[e]))}$("tr").mouseover(function(){$(this).tooltip({placement:"left"}),$(this).tooltip("show")})},Admin.prototype.tableRow=function(t){var e=t.score,i="<tr data-toggle='tooltip' title='"+t.onyen+"'>";return i+="<th>"+t.PID+"</th>",i+="<th>"+e.catright+"</th>",i+="<th>"+e.catwrong+"</th>",i+="<th>"+e.markright+"</th>",i+="<th>"+e.markwrong+"</th>",i+="<th>"+e.validright+"</th>",i+="<th>"+e.validwrong+"</th>",i+="</tr>"},Admin.prototype.addTerm=function(){var t=$("#term-input").val();$.ajax({url:dbUrl+"createTerm/",type:"GET",data:{UID:this.uid,term:t},success:function(t){console.log(t),this.getTerms(),$("#term-success").show(),$("#term-failure").hide()}.bind(this.self),error:function(t){console.log(t),$("#term-success").hide(),$("#term-failure").show()}})},Admin.prototype.getTerms=function(){$.ajax({url:dbUrl+"getTerms/",type:"GET",data:{UID:this.uid},success:function(t){this.terms=t.term,this.displayTerms()}.bind(this),error:function(t){console.log(t)}})},Admin.prototype.getTerm=function(t){$.ajax({url:dbUrl+"getTerm/",type:"GET",data:{term:t,UID:this.uid},success:function(t){this.students=t.users,this.displayStudents(),console.log(t)}.bind(this),error:function(t){}})},Admin.prototype.makeAdmin=function(){var t=$("#onyen-input").val();$.ajax({url:dbUrl+"makeAdmin/",type:"GET",data:{onyen:t,UID:this.uid},success:function(t){$("#admin-failure").hide(),$("#admin-success").show()},error:function(t){console.log(t),$("#admin-failure").show(),$("#admin-success").hide()}})},Admin.prototype.removeAdmin=function(){var t=$("#onyen-input").val();$.ajax({url:dbUrl+"removeAdmin/",type:"GET",data:{onyen:t,UID:this.uid},success:function(t){$("#admin-failure").hide(),$("#admin-success").show()},error:function(t){console.log(t),$("#admin-failure").show(),$("#admin-success").hide()}})},Admin.prototype.getStudents=function(){$.ajax({url:dbUrl+"getTerm/",type:"GET",data:{term:"phil105"},success:function(t){this.students=t.users,this.displayStudents().bind(this)}.bind(this.self),error:function(t){this.students=[]}})};
