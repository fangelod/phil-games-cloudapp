var User=function(t,e,r){this.onyen=t,this.uid=e,this.pid=r,this.problem,this.term="",this.loggedIn=!1,this.isAdmin=!1,this.self=this,this.score={},this.onyen&&this.uid&&this.getUser()};User.prototype.catRight=function(){this.postScore("catright")},User.prototype.catWrong=function(){this.postScore("catwrong")},User.prototype.markRight=function(){this.postScore("markright")},User.prototype.markWrong=function(){this.postScore("markwrong")},User.prototype.validRight=function(){this.postScore("validright")},User.prototype.validWrong=function(){this.postScore("validwrong")},User.prototype.postScore=function(t){if(this.loggedIn){this.score[t]=this.score[t]+1;var e={UID:this.uid};e[t]=!0,$.ajax({url:dbUrl+"postScore/",type:"GET",data:e,success:function(t){console.log(t)},error:function(t){console.log(response)}}),this.displayScore()}},User.prototype.addAdminbutton=function(){var t="?onyen="+this.onyen+"&pid="+this.pid+"&uid="+this.uid;$(".title-buttons").append('<a href="admin.html'+t+'"><button class="btn btn-primary">Admin</button></a>')},User.prototype.displayTerm=function(){$(".term-body").show(),$("#current-term").html(this.term),$("#update-term").click(this.assignTerm.bind(this))},User.prototype.assignTerm=function(){var t=$("#term-input").val();$.ajax({url:dbUrl+"assignTerm/",type:"GET",data:{UID:this.uid,term:t},success:function(e){this.term=t,$("#current-term").html(this.term),$("#term-alert").html("<i>Successfully Added</i>")}.bind(this.self),error:function(t){console.log(t),$("#term-alert").html('<i class="error">Term does not exist.</i>')}})},User.prototype.displayScore=function(){var t=function(t){return isNaN(t)?0:t},e=this.score;e.catpercent=t(Math.floor(100*e.catright/(e.catright+e.catwrong))),e.markpercent=t(Math.floor(100*e.markright/(e.markright+e.markwrong))),e.validpercent=t(Math.floor(100*e.validright/(e.validright+e.validwrong))),html="Categories Right: "+e.catright+"<br>",html+="Categories Wrong: "+e.catwrong+"<br>",html+="Categories Percent: "+e.catpercent+"%<br><br>",html+="Venns Right: "+e.markright+"<br>",html+="Venns Wrong: "+e.markwrong+"<br>",html+="Venns Percent: "+e.markpercent+"%<br><br>",html+="Conclusions Right: "+e.validright+"<br>",html+="Conclusions Wrong: "+e.validwrong+"<br>",html+="Conclusions Percent: "+e.validpercent+"%<br>",$(".score-body").html(html)},User.prototype.getScore=function(){$.ajax({url:dbUrl+"getScore/",type:"GET",data:{UID:this.uid},success:function(t){this.score=t,this.displayScore()}.bind(this.self),error:function(t){$(".score-body").html("Failure retrieving score"),console.log(t)}})},User.prototype.getUser=function(){$.ajax({url:dbUrl+"user/",type:"GET",data:{onyen:this.onyen,UID:this.uid,PID:this.pid},success:function(t){this.loggedIn=!0,$(".score-header").html("<i>Welcome "+this.onyen+"!</i>"),this.score=t.score,this.term=t.term,this.isAdmin=t.isAdmin,this.getScore(),this.isAdmin?this.addAdminbutton():this.displayTerm()}.bind(this.self),error:function(t){$(".score-header").html("<span class='error'>Failed to login. Please try again.</span>"),console.log(t)}})},User.prototype.getProblem=function(t){"easy"==t||"medium"==t||"hard"==t?$.ajax({url:dbUrl+"problem/",type:"GET",data:{difficulty:t},success:function(t){var e=t.categories.slice(0,3),r=t.categories.slice(3,4)[0],o=r.premises,s=r.conclusion,i={categories:e,premises:o,conclusion:s};this.problem=new Problem(i,this)}.bind(this.self),error:function(t){console.log(t)}}):$.ajax({url:dbUrl+"problem/",type:"GET",data:{difficulty:"easy"},success:function(t){var e=t.categories.slice(0,3),r=t.categories.slice(3,4)[0],o=r.premises,s=r.conclusion,i={categories:e,premises:o,conclusion:s};this.problem=new Problem(i,this)}.bind(this.self),error:function(t){console.log(t)}})},User.prototype.getLocalProblem=function(){var t=[{plural:"squibs"},{plural:"muggles"},{plural:"purebloods"}],e=["some 1 and 2 exist","no 2 are 3"],r="some 1 exist",o={categories:t,premises:e,conclusion:r};this.problem=new Problem(o,this)};
